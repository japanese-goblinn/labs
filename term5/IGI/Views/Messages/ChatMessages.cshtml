@model Twitter.ViewModels.MessagesViewModel

@{
    Layout = "_Layout";
}



<div class="text-left ml-2 mt-3">
    <div class="d-flex justify-content-start" style="font-weight: bold; font-size: x-large">
        <a class="text-dark" asp-controller="Profile" asp-action="Index" asp-route-userName="@Model.ChatWith.UserName">
            @Model.ChatWith.Name
        </a>
    </div>
    <div class="d-flex justify-content-start bd-highlight" style="color: gray">
        @@@Model.ChatWith.UserName
    </div>
</div>
<hr/>
<div style="overflow-y: scroll; height: 610px;" id="scrollview">
    @foreach (var message in Model.Messages)
    {
        <div class="ml-2 text-left">
            @if (message.SendedBy.UserName == User.Identity.Name)
            {
                <div class="d-flex">
                    <div style="font-weight: bold">
                        Me
                    </div>
                    <div class="ml-1 text-muted">
                        * @message.DateTime
                    </div>
                </div>
            }
            else
            {
                <div class="d-flex">
                    <div style="font-weight: bold">
                        @message.SendedBy.Name
                    </div>
                    <div class="ml-1 text-muted">
                        * @message.DateTime
                    </div>
                </div>
            }
            <div class="mt-1">
                @message.Text
            </div>
        </div>
        <hr/>
    }  
</div>
<hr/>
<form method="post" asp-action="SendMessage" asp-route-sendToUsername="@Model.ChatWith"
      asp-route-sendByUsername="@User.Identity.Name" class="mt-3 mb-4 form-group">
    <div class="d-flex mt-1 ml-2 mr-2">
        <div class="mr-2 flex-fill">
            <input name="message" class="form-control" placeholder="New message..."/>
        </div>
        <div>
            <input type="submit" value="Send" class="btn btn-primary"/>
        </div>
    </div>
</form>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>
    $(document).ready(function() {
        $('#scrollview').animate({
            scrollTop: $('#scrollview').get(0).scrollHeight
        }, 500);
    });
</script>

