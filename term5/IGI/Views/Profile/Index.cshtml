@model Twitter.ViewModels.ProfileViewModel

@{
    ViewData["Title"] = "Profile";
    Layout = "_Layout"; 
}

<html>
<head>
    <title>@ViewData["Title"]</title>
</head>
<body>
<div class="text-left mt-3">
    <h3 class="display-6">@ViewData["Title"]</h3>
</div>
<hr/>
<div class="d-flex">
    <div class="pl-2 d-flex flex-grow-1 flex-column bd-highlight">
        <div class="d-flex justify-content-start bd-highlight" style="font-weight: bold; font-size: x-large">
            @Model.User.Name
        </div>
        
        <div class="d-flex justify-content-start bd-highlight" style="color: gray">
            @@@Model.User.UserName
        </div>
        
        <div class="mt-2 d-flex flex-row bd-highlight">
            <div class="d-flex">
                <div style="font-weight: bold">
                    @Model.Following.Count
                </div>
                <div class="ml-1">
                    <a style="color: black" class="link" data-toggle="modal" data-target="#followingModal">
                        Following
                    </a>
                    <div class="modal fade" id="followingModal" tabindex="-1" role="dialog" 
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Following</h5>
                                </div>
                                <div class="modal-body">
                                @if (Model.Following.Count == 0)
                                {
                                    @if (Model.User.UserName == User.Identity.Name)
                                    {
                                        <div class="d-flex flex-column justify-content-center">
                                            <p>You aren’t following anyone yet :c</p>
                                            <p style="color: darkgray">
                                                When you do, they’ll be listed here and you’ll see their Tweets in your timeline.
                                            </p>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="d-flex flex-column justify-content-center">
                                            <p>This user isn’t following anyone yet</p>
                                            <p style="color: darkgray">
                                                When user do, they’ll be listed here.
                                            </p>
                                        </div>
                                    }
                                }
                                @foreach (var user in Model.Following)
                                    {
                                        <div class="pl-2 d-flex"> 
                                            <div>
                                                <a asp-controller="Profile" asp-action="Index" 
                                                   asp-route-userName="@user.UserName" class="text-dark">
                                                    @user.Name
                                                </a>
                                            </div>
                                            <div>
                                                <a class="ml-1 text-muted">
                                                    @@@user.UserName
                                                </a>
                                            </div>
                                        </div>
                                        <hr/>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ml-1 d-flex">
                <div style="font-weight: bold">
                    @Model.Followers.Count
                </div>
                <div class="ml-1">
                    <a data-toggle="modal" data-target="#followersModal" style="color: black">
                        Followers
                    </a>
                    <div class="modal fade" id="followersModal" tabindex="-1" role="dialog" 
                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">Followers</h5>
                                </div>
                                <div class="modal-body">
                                    @if (Model.Followers.Count == 0)
                                    {
                                        @if (Model.User.UserName == User.Identity.Name)
                                        {
                                            <div class="d-flex flex-column justify-content-center">
                                                <p>You don’t have any followers yet :c</p>
                                                <p style="color: darkgray">
                                                    When someone follows you, you’ll see them here
                                                </p>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="d-flex flex-column justify-content-center">
                                                <p>User don’t have any followers yet</p>
                                                <p style="color: darkgray">
                                                    When someone follows this user, you’ll see them here
                                                </p>
                                            </div>
                                        }
                                    }
                                    @foreach (var user in Model.Followers)
                                    {
                                        <div class="pl-2 d-flex">
                                            <div>
                                                <a asp-controller="Profile" asp-action="Index"
                                                   asp-route-userName="@user.UserName" class="text-dark">
                                                    @user.Name
                                                </a>
                                            </div>
                                            <div>
                                                <a class="ml-1 text-muted">
                                                    @@@user.UserName
                                                </a>
                                            </div>
                                        </div>
                                        <hr/>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (Model.User.UserName != User.Identity.Name)
    {
        <div>
            <a asp-action="WriteMessage" asp-route-userName="@Model.User.UserName"
                    type="button" class="btn btn-outline-primary mt-1" style="border-radius: 20px">
                Write message
            </a>
            @if (Model.IsCurrentUserFollowing)
            {
                <a asp-action="Unfollow" asp-route-userName="@Model.User.UserName" 
                   type="button" class="btn btn-danger mt-1" style="border-radius: 20px">
                    Unfollow
                </a>
            }
            else
            {
                <a asp-action="Follow" asp-route-userName="@Model.User.UserName" 
                   type="button" class="btn btn-outline-primary mt-1" style="border-radius: 20px">
                    Follow
                </a>
            }
        </div>
    }
</div>
<ul class="mt-4 nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
        <a class="nav-link active" id="tweets-tab" data-toggle="tab" href="#tweets" role="tab" aria-controls="home" 
           aria-selected="true">
            Tweets
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="replies-tab" data-toggle="tab" href="#replies" role="tab" aria-controls="profile" 
           aria-selected="false">
            Replies
        </a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link" id="retweets-tab" data-toggle="tab" href="#retweets" role="tab" aria-controls="home" 
           aria-selected="false">
            Retweets
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" id="likes-tab" data-toggle="tab" href="#likes" role="tab" aria-controls="contact" 
           aria-selected="false">
            Likes
        </a>
    </li>
</ul>
    <div class="tab-content" id="myTabContent">
        <div class="mt-3 tab-pane fade show active" id="tweets" role="tabpanel" aria-labelledby="home-tab">
            <div style="overflow-y: scroll; height: 545px;">
                @foreach (var tweet in Model.UserTweets)
                {
                    @await Component.InvokeAsync("Tweet", new { id = tweet.Id })
                    <hr/>
                }
            </div>
        </div>
        <div class="mt-3 tab-pane fade" id="retweets" role="tabpanel" style="overflow-y: scroll; height: 545px;"
             aria-labelledby="profile-tab">
            <div style="overflow-y: scroll; height: 545px;">
                Retweets
            </div>
        </div>
        <div class="mt-3 tab-pane fade" id="replies" role="tabpanel" style="overflow-y: scroll; height: 545px;"
             aria-labelledby="profile-tab">
            <div style="overflow-y: scroll; height: 545px;">
                Replies
            </div>
        </div>
        <div class="mt-3 tab-pane fade" id="likes" role="tabpanel" style="overflow-y: scroll; height: 545px;"
             aria-labelledby="contact-tab">
            <div style="overflow-y: scroll; height: 545px;">
                 Likes
            </div>
        </div>
    </div>
</body>
</html>